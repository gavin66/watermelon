/*! tagger - v1.0.0 - 2016-07-09
* https://github.com/gavin66/tagger#readme
* Copyright (c) 2016 gavin; Licensed MIT */
+function(a){"use strict";function b(b){var c=["getTags","addTag"];if("string"==typeof b&&c.indexOf(b)>-1){var e=this.data("tagger");return e[b]()}return this.each(function(){var c=a(this),e=c.data("tagger"),f=a.extend({},d.DEFAULTS,c.data(),"object"==typeof b&&b);e||c.data("tagger",e=new d(this,f)),"string"==typeof b&&e[b]()})}var c='[data-tagger-toggle="dropdown"]',d=function(b,c){this.$element=a(b),this.$container=a(c.container),this.options=c,this.tags=c.tags,this.lastInputValue=null,this.init()};d.DEFAULTS={container:"#tag-container",divide:!0,color:"random",tags:[],dropdown:!1},d.prototype.init=function(){var b=this;if(this.tags.forEach(function(a){b.createElement(a)}),this.$element.on("keydown.tagger.enter",a.proxy(function(a){(13==a.which||9==a.which)&&this.add(a)},this)),this.options.dropdown.items)this.createDropdown(this.options.dropdown.items);else if("object"==typeof this.options.dropdown.load){var b=this,c={success:function(a){b.createDropdown(b.options.dropdown.load.success(a))}},d=a.extend({},b.options.dropdown.load,c);a.ajax(d)}},d.prototype.add=function(a,b){var c=this;if(a&&a.preventDefault(),"string"==typeof b?c.lastInputValue=b:c.lastInputValue=c.$element.val().trim(),"boolean"==typeof this.options.divide&&this.options.divide!==!1||"string"==typeof this.options.divide){var d=" ";typeof this.options.divide===!0?d=" ":"string"==typeof this.options.divide&&(d=this.options.divide);var e=this.lastInputValue.split(d);e.forEach(function(a){a=a.trim(),0===a.length&&this.$element.val(""),-1!==this.tags.indexOf(a)&&this.$element.val(""),a.length>0&&-1===this.tags.indexOf(a)&&this.tags.push(a)&&c.createElement(a)},c)}else 0===curValue.length&&this.$element.val(""),-1!==this.tags.indexOf(curValue)&&this.$element.val(""),curValue.length>0&&-1===this.tags.indexOf(c.lastInputValue)&&c.createElement(c.lastInputValue)},d.prototype.createElement=function(b){var c=this,d=["tagger-piece-LightPink","tagger-piece-conifer","tagger-piece-sauce","tagger-piece-RedGold","tagger-piece-ultramarine","tagger-piece-swarthy","tagger-piece-ink","tagger-piece-amber"],e=document.createElement("span"),f=a(e);f.addClass("tagger-piece"),"string"==typeof this.options.color?"random"===this.options.color?f.addClass(d[Math.floor(Math.random()*d.length+1)-1]):d.indexOf(this.options.color)>-1?f.addClass(this.options.color):f.addClass("tagger-piece-ink"):f.addClass("tagger-piece-ink"),e.appendChild(document.createTextNode(b));var g=document.createElement("a");g.className="remove",g.appendChild(document.createTextNode("x")),a(g).on("click.tagger.remove",null,{input:b},function(a){a&&a.preventDefault(),c.remove(a,e)}),e.appendChild(g),this.$container.append(e),this.$element.val(""),this.dropdownClear()},d.prototype.remove=function(b,c){this.tags.indexOf(b.data.input)>-1&&this.tags.splice(this.tags.indexOf(b.data.input),1)&&a(c).fadeOut(300,function(){a(c).remove()})&&this.$element.trigger("tagger.remove",[])},d.prototype.createDropdown=function(b){var c=this,d=document.createElement("ul"),e=a(d);e.addClass("tagger-dropdown-menu");var f=null,g=null,h=null;for(var i in b)f=document.createElement("li"),g=document.createElement("a"),g.href="javascript:void(0)",g.setAttribute("data-value",b[i]),h=document.createTextNode(b[i]),g.appendChild(h),f.appendChild(g),d.appendChild(f);var j=this.$element.parent(".tagger-box");j.length&&(this.$element.attr({"data-tagger-toggle":"dropdown","aria-haspopup":"true","aria-expanded":!1}),j.append(d),a(j).on("click.tagger.dropdown","ul.tagger-dropdown-menu li>a",function(b){c.add(b,a(this).attr("data-value"))}))},d.prototype.dropdownToggle=function(b){var c=a(this);if(!c.is(".disabled, :disabled")){var e=c.parent(".tagger-box"),f=e.hasClass("open");if(d.prototype.dropdownClear(b),!f){var g={relatedTarget:this};if(e.trigger(b=a.Event("show.tagger.dropdown",g)),b.isDefaultPrevented())return;c.trigger("focus").attr("aria-expanded","true"),e.toggleClass("open").trigger(a.Event("shown.tagger.dropdown",g))}return!1}},d.prototype.dropdownClear=function(b){a(c).each(function(){var c=a(this),d=c.parent(".tagger-box"),e={relatedTarget:this};d.hasClass("open")&&(b&&"click"==b.type&&/input|textarea/i.test(b.target.tagName)&&a.contains(d[0],b.target)||(d.trigger(b=a.Event("hide.tagger.dropdown",e)),b.isDefaultPrevented()||(c.attr("aria-expanded","false"),d.removeClass("open").trigger(a.Event("hidden.bs.dropdown",e)))))})},d.prototype.destroy=function(){},d.prototype.getTags=function(){return this.tags},d.prototype.addTag=function(){this.add()};var e=a.fn.tag;a.fn.tagger=b,a.fn.tagger.Constructor=d,a.fn.tagger.noConflict=function(){return a.fn.tagger=e,this},a(document).on("click.tagger.dropdown",d.prototype.dropdownClear).on("click.tagger.dropdown",c,d.prototype.dropdownToggle)}(jQuery);